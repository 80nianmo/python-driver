<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Upgrade Guide &mdash; Cassandra Driver 2.5.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.5.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Cassandra Driver 2.5.1 documentation" href="../index.html" />
    <link rel="up" title="Object Mapper" href="../object_mapper.html" />
    <link rel="next" title="Models" href="models.html" />
    <link rel="prev" title="Object Mapper" href="../object_mapper.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="models.html" title="Models"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../object_mapper.html" title="Object Mapper"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Cassandra Driver 2.5.1 documentation</a> &raquo;</li>
          <li><a href="../object_mapper.html" accesskey="U">Object Mapper</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Upgrade Guide</a><ul>
<li><a class="reference internal" href="#functional-change">Functional Change</a></li>
<li><a class="reference internal" href="#remove-cqlengine">Remove cqlengine</a></li>
<li><a class="reference internal" href="#organization">Organization</a><ul>
<li><a class="reference internal" href="#imports">Imports</a></li>
<li><a class="reference internal" href="#package-level-aliases">Package-Level Aliases</a></li>
<li><a class="reference internal" href="#exceptions">Exceptions</a></li>
<li><a class="reference internal" href="#unicodemixin-consolidation">UnicodeMixin Consolidation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#api-deprecations">API Deprecations</a><ul>
<li><a class="reference internal" href="#schema-management">Schema Management</a></li>
<li><a class="reference internal" href="#model-inheritance">Model Inheritance</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../object_mapper.html"
                        title="previous chapter">Object Mapper</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="models.html"
                        title="next chapter">Models</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/cqlengine/upgrade_guide.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="upgrade-guide">
<h1>Upgrade Guide<a class="headerlink" href="#upgrade-guide" title="Permalink to this headline">¶</a></h1>
<p>This is an overview of things that changed as the cqlengine project was merged into
cassandra-driver. While efforts were taken to preserve the API and most functionality exactly,
conversion to this package will still require certain minimal updates (namely, imports).</p>
<p><strong>THERE IS ONE FUNCTIONAL CHANGE</strong>, described in the first section below.</p>
<div class="section" id="functional-change">
<h2>Functional Change<a class="headerlink" href="#functional-change" title="Permalink to this headline">¶</a></h2>
<p>Legacy cqlengine included a workaround for a Cassandra bug in which prepended list segments were
reversed (<a class="reference external" href="https://issues.apache.org/jira/browse/CASSANDRA-8733">CASSANDRA-8733</a>). As of
this integration, this workaround is removed. The first released integrated version emits
a warning when prepend is used. Subsequent versions will have this warning removed.</p>
</div>
<div class="section" id="remove-cqlengine">
<h2>Remove cqlengine<a class="headerlink" href="#remove-cqlengine" title="Permalink to this headline">¶</a></h2>
<p>To avoid confusion or mistakes using the legacy package in your application, it
is prudent to remove the cqlengine package when upgrading to the integrated version.</p>
<p>The driver setup script will warn if the legacy package is detected during install,
but it will not prevent side-by-side installation.</p>
</div>
<div class="section" id="organization">
<h2>Organization<a class="headerlink" href="#organization" title="Permalink to this headline">¶</a></h2>
<div class="section" id="imports">
<h3>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">¶</a></h3>
<p>cqlengine is now integrated as a sub-package of the driver base package &#8216;cassandra&#8217;.
Upgrading will require adjusting imports to cqlengine. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">cqlengine</span> <span class="kn">import</span> <span class="n">columns</span>
</pre></div>
</div>
<p>is now:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">cassandra.cqlengine</span> <span class="kn">import</span> <span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="section" id="package-level-aliases">
<h3>Package-Level Aliases<a class="headerlink" href="#package-level-aliases" title="Permalink to this headline">¶</a></h3>
<p>Legacy cqlengine defined a number of aliases at the package level, which became redundant
when the package was integrated for a driver. These have been removed in favor of absolute
imports, and referring to cannonical definitions. For example, <tt class="docutils literal"><span class="pre">cqlengine.ONE</span></tt> was an alias
of <tt class="docutils literal"><span class="pre">cassandra.ConsistencyLevel.ONE</span></tt>. In the integrated package, only the
<a class="reference internal" href="../api/cassandra.html#cassandra.ConsistencyLevel" title="cassandra.ConsistencyLevel"><tt class="xref py py-class docutils literal"><span class="pre">cassandra.ConsistencyLevel</span></tt></a> remains.</p>
<p>Additionally, submodule aliases are removed from cqlengine in favor of absolute imports.</p>
<p>These aliases are removed, and not deprecated because they should be straightforward to iron out
at module load time.</p>
</div>
<div class="section" id="exceptions">
<h3>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h3>
<p>The legacy cqlengine.exceptions module had a number of Exception classes that were variously
common to the package, or only used in specific modules. Common exceptions were relocated to
cqlengine, and specialized exceptions were placed in the module that raises them. Below is a
listing of updated locations:</p>
<table border="1" class="docutils">
<colgroup>
<col width="48%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Exception class</th>
<th class="head">New module</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CQLEngineException</td>
<td>cassandra.cqlengine</td>
</tr>
<tr class="row-odd"><td>ModelException</td>
<td>cassandra.cqlengine.models</td>
</tr>
<tr class="row-even"><td>ValidationError</td>
<td>cassandra.cqlengine</td>
</tr>
<tr class="row-odd"><td>UndefinedKeyspaceException</td>
<td>cassandra.cqlengine.connection</td>
</tr>
<tr class="row-even"><td>LWTException</td>
<td>cassandra.cqlengine.query</td>
</tr>
<tr class="row-odd"><td>IfNotExistsWithCounterColumn</td>
<td>cassandra.cqlengine.query</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="unicodemixin-consolidation">
<h3>UnicodeMixin Consolidation<a class="headerlink" href="#unicodemixin-consolidation" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">class</span> <span class="pre">UnicodeMixin</span></tt> was defined in several cqlengine modules. This has been consolidated
to a single definition in the cqlengine package init file. This is not technically part of
the API, but noted here for completeness.</p>
</div>
</div>
<div class="section" id="api-deprecations">
<h2>API Deprecations<a class="headerlink" href="#api-deprecations" title="Permalink to this headline">¶</a></h2>
<p>This upgrade served as a good juncture to deprecate certain API features and invite users to upgrade
to new ones. The first released version does not change functionality &#8211; only introduces deprecation
warnings. Future releases will remove these features in favor of the alternatives.</p>
<div class="section" id="schema-management">
<h3>Schema Management<a class="headerlink" href="#schema-management" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">cassandra.cqlengine.management.create_keyspace</span></tt> is deprecated. Instead, use the new replication-strategy-specific
functions that accept explicit options for known strategies:</p>
<ul class="simple">
<li><a class="reference internal" href="../api/cassandra/cqlengine/management.html#cassandra.cqlengine.management.create_keyspace_simple" title="cassandra.cqlengine.management.create_keyspace_simple"><tt class="xref py py-func docutils literal"><span class="pre">create_keyspace_simple()</span></tt></a></li>
<li><a class="reference internal" href="../api/cassandra/cqlengine/management.html#cassandra.cqlengine.management.create_keyspace_network_topology" title="cassandra.cqlengine.management.create_keyspace_network_topology"><tt class="xref py py-func docutils literal"><span class="pre">create_keyspace_network_topology()</span></tt></a></li>
</ul>
<p><tt class="docutils literal"><span class="pre">cassandra.cqlengine.management.delete_keyspace</span></tt> is deprecated in favor of a new function, <a class="reference internal" href="../api/cassandra/cqlengine/management.html#cassandra.cqlengine.management.drop_keyspace" title="cassandra.cqlengine.management.drop_keyspace"><tt class="xref py py-func docutils literal"><span class="pre">drop_keyspace()</span></tt></a>. The
intent is simply to make the function match the CQL verb it invokes.</p>
</div>
<div class="section" id="model-inheritance">
<h3>Model Inheritance<a class="headerlink" href="#model-inheritance" title="Permalink to this headline">¶</a></h3>
<p>The names for class attributes controlling model inheritance are changing. Changes are as follows:</p>
<ul class="simple">
<li>Replace &#8216;polymorphic_key&#8217; in the base class Column definition with <a class="reference internal" href="../api/cassandra/cqlengine/columns.html#cassandra.cqlengine.columns.Column.discriminator_column" title="cassandra.cqlengine.columns.Column.discriminator_column"><tt class="xref py py-attr docutils literal"><span class="pre">discriminator_column</span></tt></a></li>
<li>Replace the &#8216;__polymporphic_key__&#8217; class attribute the derived classes with <a class="reference internal" href="../api/cassandra/cqlengine/models.html#cassandra.cqlengine.models.Model.__discriminator_value__" title="cassandra.cqlengine.models.Model.__discriminator_value__"><tt class="xref py py-attr docutils literal"><span class="pre">__discriminator_value__</span></tt></a></li>
</ul>
<p>The functionality is unchanged &#8211; the intent here is to make the names and language around these attributes more precise.
For now, the old names are just deprecated, and the mapper will emit warnings if they are used. The old names
will be removed in a future version.</p>
<p>The example below shows a simple translation:</p>
<p>Before:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Pet</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">__table_name__</span> <span class="o">=</span> <span class="s">&#39;pet&#39;</span>
    <span class="n">owner_id</span> <span class="o">=</span> <span class="n">UUID</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">pet_id</span> <span class="o">=</span> <span class="n">UUID</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">pet_type</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span><span class="n">polymorphic_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Text</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">(</span><span class="n">Pet</span><span class="p">):</span>
    <span class="n">__polymorphic_key__</span> <span class="o">=</span> <span class="s">&#39;cat&#39;</span>

<span class="k">class</span> <span class="nc">Dog</span><span class="p">(</span><span class="n">Pet</span><span class="p">):</span>
    <span class="n">__polymorphic_key__</span> <span class="o">=</span> <span class="s">&#39;dog&#39;</span>
</pre></div>
</div>
<p>After:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Pet</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">__table_name__</span> <span class="o">=</span> <span class="s">&#39;pet&#39;</span>
    <span class="n">owner_id</span> <span class="o">=</span> <span class="n">UUID</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">pet_id</span> <span class="o">=</span> <span class="n">UUID</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">pet_type</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span><span class="n">discriminator_column</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Text</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">(</span><span class="n">Pet</span><span class="p">):</span>
    <span class="n">__discriminator_value__</span> <span class="o">=</span> <span class="s">&#39;cat&#39;</span>

<span class="k">class</span> <span class="nc">Dog</span><span class="p">(</span><span class="n">Pet</span><span class="p">):</span>
    <span class="n">__discriminator_value__</span> <span class="o">=</span> <span class="s">&#39;dog&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="models.html" title="Models"
             >next</a> |</li>
        <li class="right" >
          <a href="../object_mapper.html" title="Object Mapper"
             >previous</a> |</li>
        <li><a href="../index.html">Cassandra Driver 2.5.1 documentation</a> &raquo;</li>
          <li><a href="../object_mapper.html" >Object Mapper</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, DataStax.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>